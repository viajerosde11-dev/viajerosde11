---
const blocks = [
  {
    sectionTitle: 'A qué nos dedicamos',
    title: 'Especialistas en excursiones de grado 11',
    text:
      'Nos enfocamos unicamente en excursiones estudiantiles, entendiendo lo que necesitan los estudiantes y la tranquilidad que buscan los padres.',
    slides: [
      { tag: 'Demo 01', title: 'Planeación con colegios', tone: 'sun' },
      { tag: 'Demo 02', title: 'Agenda y logística', tone: 'ocean' },
      { tag: 'Demo 03', title: 'Cotización por curso', tone: 'coral' },
      { tag: 'Demo 04', title: 'Acompañamiento familiar', tone: 'mint' },
    ],
  },
  {
    sectionTitle: 'Seguridad y acompañamiento',
    title: 'Viajes seguros y acompañados',
    text:
      'Contamos con personal capacitado, protocolos claros y aliados confiables en transporte, hoteles y actividades.',
    slides: [
      { tag: 'Demo 01', title: 'Equipo capacitado', tone: 'ocean' },
      { tag: 'Demo 02', title: 'Protocolos activos', tone: 'mint' },
      { tag: 'Demo 03', title: 'Transporte confiable', tone: 'sun' },
      { tag: 'Demo 04', title: 'Hoteles verificados', tone: 'coral' },
    ],
  },
  {
    sectionTitle: 'La experiencia para los estudiantes',
    title: 'Momentos que se viven una sola vez',
    text:
      'Playa, amigos, fiestas, cultura y recuerdos que marcan el cierre de una etapa inolvidable.',
    slides: [
      { tag: 'Demo 01', title: 'Días de playa', tone: 'mint' },
      { tag: 'Demo 02', title: 'Noches temáticas', tone: 'coral' },
      { tag: 'Demo 03', title: 'Juegos y retos', tone: 'sun' },
      { tag: 'Demo 04', title: 'Espacios culturales', tone: 'ocean' },
    ],
  },
];
---

<section id="quienes-somos" class="relative">
  <div class="mx-auto max-w-6xl px-6 py-16">
    <div class="relative">
      <article class="glass-card relative rounded-[2.5rem] p-6 text-ink md:p-10">
        <header class="text-center">
          <p class="section-kicker">Quiénes somos</p>
          <h2 class="section-title mt-3">
            Conócenos en <span class="section-title-accent">2 minutos</span>
          </h2>
          <p class="section-subtitle">Una mirada real a cómo creamos experiencias de grado 11</p>
        </header>

        <div class="relative mt-8">
          <div class="video-accent video-accent-left"></div>
          <div class="video-accent video-accent-right"></div>
          <div class="video-shell relative overflow-hidden rounded-3xl bg-black">
            <video
              data-hero-video
              class="video-clean aspect-video w-full object-contain"
              preload="metadata"
              playsinline
            >
              <source src="/videos/quienes-somos.mp4" type="video/mp4" />
              <source src="/videos/Quienes-somos.MOV" type="video/quicktime" />
              Tu navegador no soporta este formato de video.
            </video>
            <button
              type="button"
              class="video-play-fab"
              data-video-toggle
              aria-label="Reproducir o pausar video"
            >
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path d="M8 6.5v11l9-5.5z"></path>
              </svg>
            </button>
            <div class="video-audio-control">
              <button
                type="button"
                class="video-volume-fab"
                data-video-volume
                aria-label="Silenciar video"
              >
                <svg class="icon-unmuted" viewBox="0 0 24 24" aria-hidden="true">
                  <path d="M14 5.23v13.54a1 1 0 0 1-1.64.77L8.7 16.5H5a1 1 0 0 1-1-1v-7a1 1 0 0 1 1-1h3.7l3.66-3.04A1 1 0 0 1 14 5.23z"></path>
                  <path d="M16.5 8.5a1 1 0 0 1 1.41 0 4.5 4.5 0 0 1 0 6.36 1 1 0 1 1-1.41-1.42 2.5 2.5 0 0 0 0-3.52 1 1 0 0 1 0-1.42z"></path>
                </svg>
                <svg class="icon-muted" viewBox="0 0 24 24" aria-hidden="true">
                  <path d="M14 5.23v13.54a1 1 0 0 1-1.64.77L8.7 16.5H5a1 1 0 0 1-1-1v-7a1 1 0 0 1 1-1h3.7l3.66-3.04A1 1 0 0 1 14 5.23z"></path>
                  <path d="M16.1 9.5a1 1 0 0 1 1.4 0L19 11l1.5-1.5a1 1 0 0 1 1.4 1.4L20.4 12.4l1.5 1.5a1 1 0 1 1-1.4 1.4L19 13.8l-1.5 1.5a1 1 0 0 1-1.4-1.4l1.5-1.5-1.5-1.5a1 1 0 0 1 0-1.4z"></path>
                </svg>
              </button>
              <input
                type="range"
                class="video-volume-range"
                data-video-volume-range
                min="0"
                max="100"
                value="100"
                step="1"
                aria-label="Nivel de volumen"
              />
            </div>
          </div>
        </div>

        <p class="mx-auto mt-8 max-w-3xl text-center text-base text-slate-700 md:text-lg">
          Somos Viajeros de 11, una agencia especializada en excursiones de grado 11.
          Acompañamos a estudiantes y familias en cada paso del viaje, con organización,
          seguridad y experiencias inolvidables.
        </p>

        <div class="mt-12 grid gap-8">
          {blocks.map((block, index) => (
            <article class="overflow-hidden rounded-3xl border border-white/80 bg-white/80 p-5 shadow-[0_16px_30px_rgba(11,110,168,0.12)] md:p-7">
              <div class="flex items-start gap-4">
                <span class="inline-flex h-10 w-10 items-center justify-center rounded-full bg-ocean text-sm font-bold text-white">
                  {index + 1}
                </span>
                <div>
                  <p class="text-xs font-semibold uppercase tracking-[0.2em] text-ocean-dark">
                    {block.sectionTitle}
                  </p>
                  <h3 class="mt-1 text-2xl font-bold text-ink">{block.title}</h3>
                  <p class="mt-3 max-w-3xl text-slate-700">{block.text}</p>
                </div>
              </div>

              <div class="photo-carousel mt-6 overflow-hidden rounded-2xl">
                <div class="photo-track">
                  {block.slides.concat(block.slides).map((slide, imageIndex) => (
                    <figure class={`photo-item tone-${slide.tone}`}>
                      <img
                        src="/assets/ejemplo1.jpg"
                        alt={`Montaje ${index + 1}, imagen ${((imageIndex % block.slides.length) + 1).toString()}`}
                        loading="lazy"
                        decoding="async"
                      />
                      <figcaption class="photo-caption">
                        <span>{slide.tag}</span>
                        <p>{slide.title}</p>
                      </figcaption>
                    </figure>
                  ))}
                </div>
              </div>
            </article>
          ))}
        </div>
      </article>
    </div>
  </div>
</section>

<style>
  .section-kicker {
    display: inline-flex;
    align-items: center;
    gap: 0.45rem;
    border-radius: 999px;
    border: 1px solid rgba(11, 110, 168, 0.28);
    background: linear-gradient(135deg, rgba(11, 110, 168, 0.14), rgba(255, 176, 32, 0.2));
    color: #0b6ea8;
    font-size: 0.72rem;
    font-weight: 700;
    letter-spacing: 0.18em;
    text-transform: uppercase;
    padding: 0.38rem 0.9rem;
    box-shadow: 0 8px 18px rgba(11, 110, 168, 0.14);
  }

  .section-kicker::before {
    content: '';
    width: 0.42rem;
    height: 0.42rem;
    border-radius: 999px;
    background: linear-gradient(135deg, #ffb020, #0b6ea8);
  }

  .section-title {
    font-size: clamp(1.9rem, 4.4vw, 2.9rem);
    font-weight: 800;
    line-height: 1.08;
    letter-spacing: -0.02em;
    color: #1e2326;
    text-wrap: balance;
  }

  .section-title-accent {
    display: inline-block;
    color: #0b6ea8;
    text-shadow: 0 8px 20px rgba(11, 110, 168, 0.22);
    position: relative;
    padding-inline: 0.2rem;
  }

  .section-title-accent::after {
    content: '';
    position: absolute;
    left: 0.1rem;
    right: 0.1rem;
    bottom: 0.03rem;
    height: 0.5rem;
    border-radius: 999px;
    background: linear-gradient(90deg, rgba(11, 110, 168, 0.24), rgba(255, 176, 32, 0.52));
    z-index: -1;
  }

  .section-subtitle {
    margin-top: 0.8rem;
    color: #06517c;
    font-size: 0.95rem;
    font-weight: 500;
  }

  .video-accent {
    position: absolute;
    top: 50%;
    z-index: 0;
    width: 8rem;
    height: 8rem;
    border-radius: 999px;
    pointer-events: none;
    filter: blur(30px);
    opacity: 0.42;
    transform: translateY(-50%);
  }

  .video-accent-left {
    left: -1.4rem;
    background: radial-gradient(circle, rgba(92, 198, 176, 0.75) 0%, rgba(11, 110, 168, 0.42) 52%, rgba(11, 110, 168, 0) 75%);
  }

  .video-accent-right {
    right: -1.4rem;
    background: radial-gradient(circle, rgba(255, 176, 32, 0.72) 0%, rgba(11, 110, 168, 0.38) 54%, rgba(11, 110, 168, 0) 76%);
  }

  .video-shell {
    z-index: 1;
    width: 100%;
    max-width: 85%;
    margin-inline: auto;
    border: 1px solid rgba(255, 255, 255, 0.55);
    box-shadow: 0 12px 28px rgba(6, 81, 124, 0.24), 0 0 0 1px rgba(11, 110, 168, 0.14);
    background: radial-gradient(circle at 50% 20%, rgba(20, 31, 46, 0.9), rgba(5, 9, 14, 1));
    transition: transform 0.25s ease, box-shadow 0.25s ease;
  }

  .video-play-fab {
    position: absolute;
    top: 50%;
    left: 50%;
    z-index: 2;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 4.15rem;
    height: 4.15rem;
    border-radius: 999px;
    border: 1px solid rgba(255, 255, 255, 0.7);
    background: linear-gradient(155deg, rgba(255, 255, 255, 0.95), rgba(237, 246, 252, 0.92));
    color: #06517c;
    box-shadow: 0 12px 30px rgba(3, 22, 35, 0.38);
    transform: translate(-50%, -50%);
    transition: transform 0.2s ease, box-shadow 0.2s ease, opacity 0.2s ease;
    cursor: pointer;
    animation: videoPulse 2s ease-in-out infinite;
  }

  .video-play-fab:hover {
    transform: translate(-50%, -50%) scale(1.06);
    box-shadow: 0 16px 36px rgba(3, 22, 35, 0.46);
  }

  .video-audio-control {
    position: absolute;
    right: 0.9rem;
    bottom: 0.9rem;
    z-index: 2;
    display: flex;
    align-items: center;
    border: 1px solid rgba(255, 255, 255, 0.4);
    background: rgba(7, 18, 29, 0.68);
    border-radius: 999px;
    padding: 0.3rem;
    backdrop-filter: blur(4px);
    overflow: visible;
  }

  .video-volume-fab {
    width: 2.35rem;
    height: 2.35rem;
    border-radius: 999px;
    border: 1px solid rgba(255, 255, 255, 0.55);
    background: rgba(7, 18, 29, 0.72);
    color: #ffffff;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    backdrop-filter: blur(4px);
    transition: transform 0.2s ease, background 0.2s ease, border-color 0.2s ease;
  }

  .video-volume-fab:hover {
    transform: scale(1.06);
    background: rgba(7, 18, 29, 0.85);
    border-color: rgba(255, 255, 255, 0.72);
  }

  .video-volume-fab svg {
    width: 1.15rem;
    height: 1.15rem;
    fill: currentColor;
  }

  .video-volume-fab .icon-muted {
    display: none;
  }

  .video-volume-fab.is-muted .icon-unmuted {
    display: none;
  }

  .video-volume-fab.is-muted .icon-muted {
    display: block;
  }

  .video-volume-range {
    width: 0;
    opacity: 0;
    pointer-events: none;
    transform: scaleX(0.75);
    transform-origin: right center;
    margin-left: 0;
    accent-color: #5cc6b0;
    cursor: pointer;
    transition: width 0.2s ease, opacity 0.2s ease, transform 0.2s ease, margin-left 0.2s ease;
  }

  .video-audio-control.is-open .video-volume-range {
    width: 6.2rem;
    opacity: 1;
    pointer-events: auto;
    transform: scaleX(1);
    margin-left: 0.35rem;
  }

  .video-play-fab svg {
    width: 1.7rem;
    height: 1.7rem;
    margin-left: 0.15rem;
    fill: currentColor;
  }

  .video-play-fab.is-hidden {
    opacity: 0;
    pointer-events: none;
  }

  .video-shell:hover {
    transform: translateY(-2px);
    box-shadow: 0 18px 34px rgba(6, 81, 124, 0.28), 0 0 0 1px rgba(11, 110, 168, 0.2);
  }

  .photo-carousel {
    --item-width: 280px;
    position: relative;
    max-width: 100%;
    overflow: hidden;
    isolation: isolate;
    border-radius: 1rem;
    padding: 0.2rem 0;
  }

  .photo-track {
    display: flex;
    gap: 1rem;
    width: max-content;
    will-change: transform;
    animation: gallerySlide 56s linear infinite;
  }

  .photo-item {
    position: relative;
    width: var(--item-width);
    flex: 0 0 var(--item-width);
    border-radius: 1rem;
    overflow: hidden;
    box-shadow: 0 12px 22px rgba(2, 42, 65, 0.18);
  }

  .photo-item img {
    width: 100%;
    height: 180px;
    object-fit: cover;
    display: block;
    filter: saturate(1.05) contrast(1.02);
  }

  .photo-item::after {
    content: '';
    position: absolute;
    inset: 0;
    z-index: 1;
    opacity: 0.78;
  }

  .tone-sun::after {
    background: linear-gradient(160deg, rgba(255, 176, 32, 0.56), rgba(6, 81, 124, 0.35));
  }

  .tone-ocean::after {
    background: linear-gradient(160deg, rgba(11, 110, 168, 0.56), rgba(30, 35, 38, 0.42));
  }

  .tone-coral::after {
    background: linear-gradient(160deg, rgba(244, 109, 79, 0.56), rgba(6, 81, 124, 0.32));
  }

  .tone-mint::after {
    background: linear-gradient(160deg, rgba(92, 198, 176, 0.56), rgba(11, 110, 168, 0.32));
  }

  .photo-caption {
    position: absolute;
    right: 0.8rem;
    left: 0.8rem;
    bottom: 0.8rem;
    z-index: 2;
    border-radius: 0.8rem;
    border: 1px solid rgba(255, 255, 255, 0.35);
    background: rgba(15, 23, 42, 0.46);
    padding: 0.7rem;
    color: #fff;
    backdrop-filter: blur(4px);
  }

  .photo-caption span {
    display: inline-flex;
    border-radius: 999px;
    border: 1px solid rgba(255, 255, 255, 0.35);
    background: rgba(255, 255, 255, 0.15);
    padding: 0.2rem 0.55rem;
    font-size: 0.67rem;
    font-weight: 700;
    letter-spacing: 0.08em;
    text-transform: uppercase;
  }

  .photo-caption p {
    margin-top: 0.45rem;
    font-size: 0.86rem;
    font-weight: 700;
    line-height: 1.2;
  }

  .photo-carousel:hover .photo-track {
    animation-play-state: paused;
  }

  @media (max-width: 768px) {
    .video-accent {
      width: 5.8rem;
      height: 5.8rem;
      opacity: 0.36;
    }

    .video-accent-left {
      left: -0.9rem;
    }

    .video-accent-right {
      right: -0.9rem;
    }

    .video-shell {
      max-width: 100%;
    }

    .video-audio-control {
      right: 0.6rem;
      bottom: 0.6rem;
      padding: 0.2rem;
    }

    .video-volume-fab {
      width: 1.9rem;
      height: 1.9rem;
    }

    .video-volume-fab svg {
      width: 1rem;
      height: 1rem;
    }

    .video-volume-range {
      position: absolute;
      right: -1.15rem;
      bottom: 3.5rem;
      width: 4.8rem;
      margin-left: 0;
      padding: 0.35rem 0.25rem;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.45);
      background: rgba(7, 18, 29, 0.84);
      transform: rotate(-90deg) scale(0.9);
      transform-origin: right bottom;
    }

    .video-audio-control.is-open .video-volume-range {
      width: 4.8rem;
      margin-left: 0;
      transform: rotate(-90deg) scale(1);
    }

    .photo-carousel {
      --item-width: 220px;
    }

    .photo-item img {
      height: 150px;
    }
  }

  @keyframes gallerySlide {
    from {
      transform: translateX(0);
    }
    to {
      transform: translateX(-50%);
    }
  }

  @keyframes videoPulse {
    0%,
    100% {
      box-shadow: 0 12px 30px rgba(3, 22, 35, 0.38), 0 0 0 0 rgba(255, 255, 255, 0.32);
    }
    50% {
      box-shadow: 0 14px 34px rgba(3, 22, 35, 0.42), 0 0 0 14px rgba(255, 255, 255, 0);
    }
  }

</style>

<script>
  const video = document.querySelector('[data-hero-video]');
  const toggle = document.querySelector('[data-video-toggle]');
  const volume = document.querySelector('[data-video-volume]');
  const volumeRange = document.querySelector('[data-video-volume-range]');
  const audioControl = document.querySelector('.video-audio-control');

  if (
    video instanceof HTMLVideoElement &&
    toggle instanceof HTMLButtonElement &&
    volume instanceof HTMLButtonElement &&
    volumeRange instanceof HTMLInputElement &&
    audioControl instanceof HTMLDivElement
  ) {
    let lastVolume = 1;
    let closeTimer;

    const syncState = () => {
      toggle.classList.toggle('is-hidden', !video.paused);
      volume.classList.toggle('is-muted', video.muted);
      volume.setAttribute('aria-label', video.muted ? 'Activar sonido' : 'Silenciar video');
      volumeRange.value = String(Math.round((video.muted ? 0 : video.volume) * 100));
    };

    const openVolume = () => {
      audioControl.classList.add('is-open');
      clearTimeout(closeTimer);
      closeTimer = setTimeout(() => {
        audioControl.classList.remove('is-open');
      }, 2200);
    };

    toggle.addEventListener('click', () => {
      if (video.paused) {
        void video.play();
      } else {
        video.pause();
      }
    });

    volume.addEventListener('click', () => {
      openVolume();
      if (!video.muted && video.volume > 0) {
        lastVolume = video.volume;
        video.muted = true;
      } else {
        video.muted = false;
        video.volume = Math.max(lastVolume, 0.1);
      }
      syncState();
    });

    volumeRange.addEventListener('input', () => {
      openVolume();
      const next = Number(volumeRange.value) / 100;
      video.volume = next;
      video.muted = next === 0;
      if (next > 0) {
        lastVolume = next;
      }
      syncState();
    });

    video.addEventListener('click', () => {
      if (video.paused) {
        void video.play();
      } else {
        video.pause();
      }
    });

    video.addEventListener('play', syncState);
    video.addEventListener('pause', syncState);
    video.addEventListener('ended', syncState);
    video.addEventListener('volumechange', syncState);
    video.volume = 1;
    video.muted = false;
    syncState();

    document.addEventListener('click', (event) => {
      const target = event.target;
      if (!(target instanceof Node)) return;
      if (!audioControl.contains(target)) {
        audioControl.classList.remove('is-open');
      }
    });
  }
</script>

